# 네트워크 계층 (Network Layer)

송수신 호스트 사이의 패킷 전달 경로를 선택하는 라우팅이다. 라우팅 과정에서 일어나는 문제도 네트워크 계층에서 처리한다.
네트워크의 특정 지역에 트패깅이 몰리는 현상을 다루는 홉잡 제어와 라우터 사이의 패킷 중개 과정에서 다루는 패킷의 분할과 병합이다.


### 비연결형


> 비연결형 서비스

  * 패킷의 전달 순서, 패킷 분실 여부 등에서 연결형 서비스보다 신뢰성이 떨어지는 전송 방식이다.
  * 자체적으로 오류 제어와 흐름 제어 기능을 더 많이 수행해야 한다.
  * 패킷이 서로 다른 경로를 통해 목적지 호스트로 전달되기 때문에 패킷이 도착하는 순서가 일정하지 않을 수 있다. 수신한 패킷의 순서를 재조정해야 한다.

> 데이터 그램

  * 연결 설정 과정이 없기 때문에 송수신 호스트 사이에 고정 경로가 존재하지 않는다.
  * 전송 패킷마다 독립적인 전달 경로를 선택해야 한다.

### 연결형


> 연결형 서비스

  * 상대적으로 신뢰성이 높은 서비스이다.
  * 패킷을 전송하기 전에 연결을 미리 설정하여 송신하는 방식이다.
  * 모두 동일한 경로를 이용하기 때문에 목적지에 도착하는 패킷의 순서가 송신된 순서와 동일하다는 특성이 있다.
  * 가상 회선 방식을 사용한다.
  
> 가상 회선 방식

  * 송수신 호스트 사이의 경로 선택은 연결이 설정되는 시점에 한 번만 결정하고, 이후의 패킷들은 이 경로를 따라 목적지까지 전달된다.
  * 전송되는 모든 패킷이 동일 경로를 거치고, 패킷의 전달 순서도 일정하게 유지된다.

### Routing


> 라우팅(Routing)

  송수신 호스트 사이의 패킷 전달 경로를 선택하는 과정을 라우팅이라고 하고, 라우팅 테이블 정보는 네트워크 관리자나 네트워크 자신의 판단에 의해 계속 변경된다.
  
  * 패킷의 전송 결로를 지정하는 방법
  * 들어온 패킷을 어느 출력 경로를 통해 다음 호스트로 전달해야 가장 효과적인지 결정하는 것이다.

> 정적 라우팅
  
  * 송수신 호스트 사이에서 패킷 전송이 이루어지기 전에 경로 정보를 라우터에 미리 저장하여 중개하는 방식이다.
  * 운용 중인 네트워크의 구성에 변화가 생기면 이에 적절하게 대처할 수 없다는 문제점이 있다.
  * 라우터에 보관된 경로 정보가 고정되어 변화된 정보를 갱신하기가 쉽지 않다.
  * 네트워크 내부의 혼잡도를 반영할 수 없다는 단점이 있다.

> 동적 라우팅
  
  * 라우터에서 사용하는 경로 정보를 네트워크 상황에 따라 적절하게 변경하는 방식으로, 경로 정보의 변경 주기에 따라 계속 보완할 수 있다.
  * 네트워크 상황을 고려해 최적의 경로 정보를 선택할 수 있다.
  * 경로 정보를 수집하고 관리하는 등의 복잡한 작업이 추가로 필요하다.

> HELLO/ECHO
  
  * 이웃에 연결된 라우터에 초기화를 위한 HELLO 패킷을 전송해 경로 정보를 얻는다.
  * 라우터 사이의 전송 지연 시간을 측정하기 위해서 ECHO 패킷을 전송한다.

> 라우팅 테이블(Routing Table)
  
  * 목적지 호스트에는 패킷의 최종 목적지가 되는 호스트의 주소 값을, 다음 홉에는 목적지 호스트까지 패킷을 전달하기 위한 이웃 라우터를 지정하는 테이블.

> RIP(Routing Information Protocol) 프로토콜

  * 거리 벡터 방식을 사용하는 내부 라우팅 프로토콜 중에서 가장 간단하게 구현된 것이다.
  * 소규모 네트워크 환경에 적합하며, 현재 가장 많이 사용하는 라우팅 프로토콜 중 하나이다.

> 링크 상태 라우팅(Link State) 프로토콜

  * 개별 라우터가 이웃 라우터까지의 거리 정보를 구한 후, 이를 네트워크에 연결된 모든 라우터에 통보한다.
  * 거리 벡터 라우팅의 단점을 극복하기 위한 프로토콜이다.
  * 플러딩 기법을 사용한다.


### IP 프로토콜

> IP Protocol

  * 비연결형 서비스를 제공한다.(UDP)
  * 패킷을 분할/병합하는 기능을 수행한다.
  * 데이터 체크섬은 제공하지 않고, 헤더 체크섬만 제공한다.
  * Best Effort 원칙에 따른 전송 기능을 제공한다. 전부 다 완벽히 보내는건 아니다라는 말

### 혼잡제어

  
> 혼잡제어(Congestion Control)

  네트워크에 패킷 수가 과도하게 증가하는 현상을 혼잡(Congestion)이라고 하고, 혼잡 현상을 예방하거나 제거하는 기능을 혼잡제어(Congestion Control)이라 한다.
  
  * 네트워크의 처리 능력보다 지나치게 많은 패킷이 입력되면 혼잡이 발생한다.
  * 라우터의 출력 선로를 통한 전송 용량이 부족해 아직 전송하지 못한 패킷이 버퍼에 저장되고, 입력 선로로 들어오는 패킷이 늘면서 버퍼 용령은 더 부족해진다.
  * 라우터의 내부 버퍼 용량 부족이 심화되어 더 이상 패킷을 보관할 수 없어 버리게 된다.
  * 전송 패킷이 버려지면 송신 호스트는 타임아웃 동작을 통해 패킷을 재전송하므로 네트워크로 송신되는 패킷의 양이 점점 늘어난다.
  * 패킷을 잃어버리지 않으려면 버퍼 용량을 늘려야하는데, 패킷의 전송 지연 시간도 함께 늘어난다.
  * 네트워크로 보내지는 패킷의 양과 중복 패킷을 수신하는 현상도 증가하여 네트워크 혼잡도가 계속 증가하는 악순환을 초래한다.

> 패킷의 분할과 병합

  큰 데이터를 여러 패킷으로 나누는 과정을 패킷 분할(Segmentation)이라고 하고, 반대로 목적지에서 분할된 패킷을 다시 모으는 과정을 병합(Reassembly)이라 한다. 패킷의 분할과 병합 과정이 양 끝단 시스템 사이에서 이루어지는 경우라면 전송 계층이 동작하는 종단 수신 시스템에 분할된 패킷을 보내고, 네트워크 계층에서 이루어지는 경우라면 중간의 각 라우터에서 분할과 병합을 반복한다.
  

  
